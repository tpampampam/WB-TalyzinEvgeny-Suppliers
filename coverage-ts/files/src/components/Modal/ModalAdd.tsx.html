
  <!DOCTYPE html>
  <html>
    <head>
      <title>ModalAdd.tsx</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">src/components/Modal/ModalAdd.tsx</td><td class="">100.00%</td><td class="">80%</td><td class="">232</td><td class="">232</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import { ChangeEvent, FC, useState } from &#x27;react&#x27;
import { CITY_WAREHOUSES, Change, Cities, DATA, WAREHOUSES } from &#x27;../../utils/constants&#x27;
import { ModalButton } from &#x27;./ModalButton&#x27;
import { Card, useAddNewCardMutation} from &#x27;../../redux/api/apiSlice&#x27;
import CloseButton from &#x27;./CloseButton&#x27;
import ModalTitle from &#x27;./ModalTitle&#x27;
import ModalItem from &#x27;./ModalItem&#x27;

interface ModalAddProps  {
    id: string
    number: string
    isOpen: boolean
    modalStatus: (value: boolean) =&gt; void
}


const ModalAdd:FC&lt;ModalAddProps&gt; = ({id, number, isOpen, modalStatus}) =&gt; {

    const [addNewCard, {isLoading}] = useAddNewCardMutation() 

    const [values, setValues] = useState&lt;Card&gt;({
        id,
        date: &#x27;&#x27;,
        number,
        city: &#x27;&#x27; as Cities,
        type: &#x27;&#x27;,
        warehouse: &#x27;&#x27;,
        address: &#x27;&#x27;,
        status,
        quantity: 0
    });
    const handleUpdate = () =&gt; {
        addNewCard(values).unwrap()
        modalStatus(false);
      };

    const handleDropdownSelect = (field: string, {value, label}: Change) =&gt; {
        if(field === &#x27;city&#x27;) {
            const firstWarehouse = CITY_WAREHOUSES[label as Cities][0] 
            setValues(prev =&gt; ({
                ...prev,
                city: label as Cities,
                warehouse: firstWarehouse.label,
                address: WAREHOUSES[firstWarehouse.value]
            }))
        } else if (field === &#x27;warehouse&#x27;) {
            console.log(value, label)
            setValues(prev =&gt; ({
                ...prev,
                warehouse: label,
                address: WAREHOUSES[value]
            }))
        } else {
            setValues(prev =&gt; ({
                ...prev,
                [field]: label,
            }));
        }
        
    };

    const handleInputChange = (event: ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {
        const { name, value } = event.target;
        setValues((prevValues) =&gt; ({
        ...prevValues,
        [name]: value,
        }));
    };

    if(isLoading) return &lt;div&gt;Loading...&lt;/div&gt;
    if (!isOpen) {
        return null;
    }
    const filtredWareHouses = CITY_WAREHOUSES[values.city] || [] 
    return(
        &lt;div className=&quot;modal&quot;&gt;
            &lt;div className=&quot;modal__container&quot;&gt;
                &lt;CloseButton onClick={() =&gt; modalStatus(false)}/&gt;
                &lt;div className=&quot;modal__form&quot;&gt;
                    &lt;ModalTitle
                        title=&#x27;Новая поставка&#x27;
                        number={number}
                    /&gt;
                    &lt;div className=&quot;modal__content&quot;&gt;
                        &lt;ModalItem
                            type=&#x27;calendar&#x27;
                            title=&#x27;Дата поставки&#x27;
                            selectedOption={values.date}
                            onSelect={(option: Change) =&gt; handleDropdownSelect(&#x27;date&#x27;, option)}
                        /&gt; 
                        &lt;ModalItem
                            type=&#x27;drop&#x27;
                            title=&#x27;Город&#x27;
                            label={values.city}
                            options={DATA.city}
                            selectedOption={values.city}
                            onSelect={(option: Change) =&gt; handleDropdownSelect(&#x27;city&#x27;, option)}
                        /&gt;
                         &lt;ModalItem
                            type=&#x27;drop&#x27;
                            title=&#x27;Тип поставки&#x27;
                            label={values.type}
                            options={DATA.type}
                            selectedOption={values.type}
                            onSelect={(option: Change) =&gt; handleDropdownSelect(&#x27;type&#x27;, option)}
                        /&gt;
                        &lt;ModalItem
                            type=&#x27;input&#x27;
                            title=&#x27;Количество&#x27;
                            label={values.type}
                            value={values.quantity} 
                            onChange={handleInputChange}
                        /&gt;   
                        &lt;ModalItem
                            type=&#x27;drop&#x27;
                            title=&#x27;Склад&#x27;
                            label={values.warehouse}
                            options={filtredWareHouses }
                            selectedOption={values.warehouse}
                            onSelect={(option: Change) =&gt; handleDropdownSelect(&#x27;warehouse&#x27;, option)}
                        /&gt;
                          &lt;ModalItem
                            type=&#x27;drop&#x27;
                            title=&#x27;Статус&#x27;
                            label={status}
                            options={DATA.status}
                            selectedOption={values.status}
                            onSelect={(option: Change) =&gt; handleDropdownSelect(&#x27;status&#x27;, option)}
                        /&gt; 
                        &lt;div className=&quot;modal__btns&quot;&gt;
                            &lt;ModalButton 
                                type=&quot;submit&quot;
                                title=&#x27;Создать&#x27;
                                onClick={handleUpdate}
                            /&gt;
                            &lt;ModalButton
                                type=&quot;cancel&quot;
                                title=&#x27;Отменить&#x27;  
                                onClick={() =&gt; modalStatus(false)}
                            /&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    )
}

export default ModalAdd;
</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 20 Jun 2024 14:29:19 GMT</p>
    </body>
  </html>
  